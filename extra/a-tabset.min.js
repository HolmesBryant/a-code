class ATabset extends HTMLElement{#direction="row";#justify="stretch";#selected=1;eventChanged="changed";justifyValues=["stretch","start","end","center","space-around","space-between"];numTabs;abortController;slotObserver;static observedAttributes=["justify","selected"];static template=' <style> :host {--bg1-color: rgb(250,250,250); --bg2-color: rgb(240,240,240); --bg3-color: white; --text-color: rgb(40,40,40); --border-color: silver; --marker-color: rgb(240,240,240); --marker-style: solid; --marker-thickness: 2px; --scrollbar-width: 2px; --pad: .5rem; --scrollbar-thumb-color: dodgerblue; --scrollbar-track-color: transparent; overflow: hidden; height: 400px; width: 100%; } ::-webkit-scrollbar {background-color: var(--scrollbar-track-color); width: var(--scrollbar-width); } ::-webkit-scrollbar-thumb { background-color: var(--scrollbar-thumb-color) } hr {border-width: var(--marker-thickness); border-style: var(--marker-style); border-color: var(--marker-color); display: inline-block; margin: 0; position: absolute; top: -2px; transition: left .25s; z-index: 1; } main {border-radius: var(--pad); display: flex; flex-direction: column; height: inherit; overflow: hidden; position: relative; } /* direction */ main.column, main.column-reverse {border: 1px solid var(--border-color); flex-direction: row; flex-wrap: nowrap; } main.column .tab, main.column-reverse .tab {border-top-left-radius: 0; border-top-right-radius: 0; border-top: none; border-left: none; } main.column .tab.selected, main.column-reverse .tab.selected { border-right-color: var(--bg3-color) } main.column #tabs, main.column-reverse #tabs {flex: 0; width: max-content; flex-direction: column; } main.column #tabs { flex-direction: column; } main.column-reverse #tabs { flex-direction: column-reverse; } main.column #content {border: none; border-bottom-left-radius: 0; } main.row-reverse #tabs { flex-direction: row-reverse; } /* justify */ .stretch > * { flex: 1; } .tab {background-color: var(--bg2-color); border: 1px solid var(--border-color); border-bottom: none; border-top-left-radius: var(--pad); border-top-right-radius: var(--pad); box-sizing: border-box; color: var(--text-color); cursor: pointer; padding: var(--pad); text-align: center; transition: all .5s; } .tab:hover { text-decoration: underline; } .tab.selected {border: 1px solid var(--border-color); background-color: var(--bg3-color); } #tabs {display: flex; flex-direction: row; flex-wrap: wrap; justify-content: var(--justify); list-style: none; padding: 0; position: relative; z-index:  1; margin: 0; } #content > div {box-sizing: border-box; opacity: 0; overflow: auto; transition: opacity 0.5s ease-in-out; padding: var(--pad); position: absolute; top: 0; left: 0; width: 100%; height: 100%; } #content {background-color: var(--bg3-color); border: 1px solid var(--border-color); border-bottom-left-radius: var(--pad); border-bottom-right-radius: var(--pad); box-sizing: border-box; color: var(--text-color); position: relative; height: calc(100% - 1px); flex: 2; } #content > div.active {opacity: 1; z-index: 1; } #row { position: relative; } </style> <main> <nav id="tabs" part="tabs"> <slot name="title"></slot> </nav> <div id="row"> <hr part="marker"> </div> <div id="content" part="content"> <slot name="content"></slot> </div> </main> <slot></slot> ';constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=this.constructor.template,this.tabsContainer=this.shadowRoot.querySelector("#tabs"),this.contentContainer=this.shadowRoot.querySelector("#content"),this.selectTab=this.selectTab.bind(this)}connectedCallback(){this.setDirection(this.direction),this.setJustify(this.justify),this.renderTabs(),this.setMarker(),this.slotObserver=new MutationObserver((()=>this.renderTabs())),this.slotObserver.observe(this,{childList:!0})}attributeChangedCallback(attr,oldval,newval){this[attr]=newval}disconnectedCallback(){this.slotObserver.disconnect(),this.abortController.abort()}notify(property,value,oldValue){const options={detail:{property:property,value:value,oldValue:oldValue}},evt=new CustomEvent(this.eventChanged,options);this.dispatchEvent(evt)}setDirection(value){this.shadowRoot.querySelector("main").className=value}setJustify(value){const tabs=this.shadowRoot.querySelector("#tabs");if("stretch"===value)tabs.classList.add("stretch");else tabs.classList.remove("stretch"),this.style.setProperty("--justify",value);return!0}setMarker(){const marker=this.shadowRoot.querySelector("hr"),selected=this.shadowRoot.querySelector(".selected");if(!selected)return;const left=selected.offsetLeft+1+"px",width=selected.offsetWidth-6+"px";marker.style.left=left,marker.style.width=width}renderTabs(){const tabTitles=this.querySelectorAll('[slot="title"]'),tabContents=this.querySelectorAll('[slot="content"]');if(this.abortController=new AbortController,this.tabsContainer.replaceChildren(),this.contentContainer.replaceChildren(),tabTitles.length!==tabContents.length)throw new Error("Number of tab titles and contents must match.");this.numTabs=tabTitles.length,tabTitles.forEach(((titleElement,index)=>{const tabElement=document.createElement("li");tabElement.classList.add("tab"),tabElement.setAttribute("part","tab"),tabElement.append(titleElement),tabElement.addEventListener("click",(()=>this.selectTab(index+1))),this.tabsContainer.appendChild(tabElement);const contentElement=document.createElement("div");contentElement.appendChild(tabContents[index].cloneNode(!0)),this.contentContainer.appendChild(contentElement)})),this.selectTab(this.selected)}selectTab(index){const realIndex=index-1,tabs=this.tabsContainer.children,contentDivs=this.contentContainer.children;if(!(index>tabs.length||index<1)){for(let i=0;i<tabs.length;i++)tabs[i].classList.toggle("selected",i===realIndex),contentDivs[i].classList.toggle("active",i===realIndex);index!==this.selected&&(this.selected=index),this.setMarker()}}get direction(){return this.#direction}set direction(value){if("column"===value)this.#direction=value;else this.#direction="row";this.setDirection(value)}get justify(){return this.#justify}set justify(value){value=value.toLowerCase(),this.setJustify(value)&&(this.notify("justify",value,this.#justify),this.#justify=value)}get selected(){return this.#selected}set selected(value){value=+value,this.notify("selected",value,this.#selected),this.#selected=value,this.selectTab(value)}}customElements.get("a-tabset")||customElements.define("a-tabset",ATabset);
